(()=>(e,t)=>{(async()=>{const e=["https://www.bilibili.com/video/","https://www.bilibili.com/watchlater/","https://www.bilibili.com/medialist/play/"];if(!e.some((e=>document.URL.startsWith(e)))){return}const i={enable:[".multi-page .next-button",".player-auxiliary-autoplay-switch input"],disable:[".recommend-list .next-button"]};const o=[()=>Boolean(dq(".multi-page .list-box li.on:last-child"))];const l=e=>Boolean(e.querySelector(".switch-button.on, :checked"));const{playerReady:n}=await t.importAsync("player-ready");await n();const a=async()=>{const e=await SpinQuery.select([...i.disable,...i.enable].join(","));if(!e){return}const t=i.enable.some((t=>e.matches(t)))&&o.every((e=>!Boolean(e())));const n=l(e);console.log(n,t,e);if(t!==n){e.click()}};Observer.videoChange((()=>{const e=dq(".bilibili-player-video video");a();e===null||e===void 0?void 0:e.addEventListener("ended",a)}))})()})();